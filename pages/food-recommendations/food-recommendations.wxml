<!--pages/food-recommendations/food-recommendations.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
  <view class="title-bar">
    <view class="back-btn" bindtap="goBack">
      <text class="back-icon">â†</text>
    </view>
    <view class="title-content">
      <text class="chatbot-name">æ¯”æ ¼å°åŠ©æ‰‹</text>
      <text class="chatbot-subtitle">æ™ºèƒ½ç¾é£Ÿæ¨èä¸“å®¶</text>
    </view>
    <view class="status-indicator">
      <view class="status-dot"></view>
      <text class="status-text">åœ¨çº¿</text>
    </view>
  </view>

  <!-- èŠå¤©æ¶ˆæ¯åŒºåŸŸ -->
  <scroll-view class="chat-container" scroll-y="true" scroll-into-view="msg-{{messages.length}}" enhanced="true" show-scrollbar="false">
    <view class="messages">
      <block wx:for="{{messages}}" wx:key="id">
        <view class="message-item {{item.type === 'user' ? 'user-message' : 'bot-message'}}" id="msg-{{item.id}}">
          <!-- å¤´åƒåŒºåŸŸ - åªæ˜¾ç¤ºæœºå™¨äººå¤´åƒ -->
          <view wx:if="{{item.type === 'bot'}}" class="avatar-wrapper">
            <view class="bot-avatar-container">
              <view class="bot-avatar-frame">
                <image class="bot-avatar-img" src="../../images/beagle-dog.png" mode="aspectFit"></image>
              </view>
              <view class="bot-name-tag">æ¯”æ ¼</view>
            </view>
          </view>

          <!-- æ¶ˆæ¯å†…å®¹åŒºåŸŸ -->
          <view class="message-content-wrapper">
            <view class="message-bubble {{item.type === 'user' ? 'user-bubble' : 'bot-bubble'}}">
              <view class="bubble-content">
                <text class="message-text">{{item.content}}</text>
              </view>
              <view class="bubble-tail {{item.type === 'user' ? 'user-tail' : 'bot-tail'}}"></view>
            </view>
            <view class="message-meta">
              <text class="message-time">{{item.time}}</text>
              <view wx:if="{{item.type === 'bot'}}" class="message-status">
                <text class="status-icon">âœ“</text>
              </view>
            </view>
          </view>
        </view>
      </block>
    </view>
  </scroll-view>

  <!-- è¾“å…¥åŒºåŸŸ -->
  <view class="input-area">
    <view class="input-container">
      <view class="input-wrapper">
        <input 
          class="message-input" 
          placeholder="è¾“å…¥æ¶ˆæ¯..." 
          placeholder-class="input-placeholder"
          value="{{inputValue}}"
          bindinput="onInputChange"
          bindconfirm="sendMessage"
          confirm-type="send"
          maxlength="200"
        />
        <view class="input-actions">
          <view class="action-btn emoji-btn">
            <text class="action-icon">ğŸ˜Š</text>
          </view>
        </view>
      </view>
      <view class="send-btn {{inputValue.trim() ? 'active' : ''}}" bindtap="sendMessage">
        <text class="send-icon">å‘é€</text>
      </view>
    </view>
  </view>
</view> 